{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var s=Object.create;var h=Object.defineProperty;var a=Object.getOwnPropertyDescriptor;var o=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty;var d=r=>h(r,\"__esModule\",{value:!0});var m=(r,i)=>()=>(i||r((i={exports:{}}).exports,i),i.exports),g=(r,i)=>{d(r);for(var n in i)h(r,n,{get:i[n],enumerable:!0})},f=(r,i,n)=>{if(i&&typeof i==\"object\"||typeof i==\"function\")for(let t of o(i))!p.call(r,t)&&t!==\"default\"&&h(r,t,{get:()=>i[t],enumerable:!(n=a(i,t))||n.enumerable});return r},b=r=>f(d(h(r!=null?s(u(r)):{},\"default\",r&&r.__esModule&&\"default\"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);var c=m((v,l)=>{l.exports=_jsx_runtime});var z={};g(z,{default:()=>k,frontmatter:()=>y});var e=b(c()),y={title:\"Shell startup scripts\",date:\"2019-12-12\",tags:[\"unix\",\"linux\",\"macOS\",\"bash\",\"zsh\",\"dotfiles\"],draft:!1,summary:\"What loads when in your terminal or shell session\",images:[],layout:\"PostLayout\"};function w(r={}){let{wrapper:i}=r.components||{};return i?(0,e.jsx)(i,Object.assign({},r,{children:(0,e.jsx)(n,{})})):n();function n(){let t=Object.assign({p:\"p\",em:\"em\",blockquote:\"blockquote\",a:\"a\",code:\"code\",h2:\"h2\",span:\"span\",strong:\"strong\",h3:\"h3\",ul:\"ul\",li:\"li\",table:\"table\",thead:\"thead\",tr:\"tr\",th:\"th\",tbody:\"tbody\",td:\"td\"},r.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(t.p,{children:(0,e.jsx)(t.em,{children:\"originally published 2019\"})}),(0,e.jsx)(t.blockquote,{children:(0,e.jsxs)(t.p,{children:[\"2022 update: When I set up a new M1 Mac work machine homebrew recommended I load it in \",(0,e.jsxs)(t.a,{href:\"https://github.com/erikdstock/dotfiles/blob/c0688bcbe49b27c20ca1310505486120a992a957/homedir/zprofile\",children:[\"my \",(0,e.jsx)(t.code,{children:\"~/.zprofile\"})]}),\". This complicates the takeaways I give below, but I guess the main update would be that tools you need only for interactive sheels can go in there. My dotfiles need an overhaul.\"]})}),(0,e.jsxs)(t.p,{children:[\"MacOS 10.15 (Catalina) changed the default shell from \",(0,e.jsx)(t.code,{children:\"bash\"}),\" to \",(0,e.jsx)(t.code,{children:\"zsh\"}),\", which encouraged me to finally figure out what the heck is going on when I log in and why my dotfiles always feel like such a mess. This includes both the strange loading logic (of \",(0,e.jsx)(t.code,{children:\"bash\"}),\" in particular) as well as the quirks that Apple's macOS adds to the mix. It turns out that it's not that bad. (Note: for all purposes here I am only talking about shells loaded via a [GUI] Terminal app)\"]}),(0,e.jsxs)(t.h2,{id:\"default-shell-startup-script-loading-order\",children:[(0,e.jsx)(t.a,{href:\"#default-shell-startup-script-loading-order\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(t.span,{className:\"icon icon-link\"})}),\"Default shell startup script loading order\"]}),(0,e.jsxs)(t.p,{children:[\"The charts below are copied from a \",(0,e.jsx)(t.a,{href:\"https://shreevatsa.wordpress.com/2008/03/30/zshbash-startup-files-loading-order-bashrc-zshrc-etc/\",children:\"2008 blog post\"}),\" that stands the test of time.\"]}),(0,e.jsxs)(t.p,{children:[\"They illustrate how a given shell environment selects which scripts to execute on startup, beginning from the top of a given column and continuing through each script marked with a letter in alphabetical order- but only the \",(0,e.jsx)(t.em,{children:\"first\"}),\" file found for each letter. The columns account for varying strategies depending on whether the shell is being created for a script or for an interactive shell and, in the later case, whether the interactive shell is a login shell.\"]}),(0,e.jsxs)(t.p,{children:[\"In Unix terms, a \",(0,e.jsx)(t.em,{children:\"login shell\"}),\" is the shell used at startup - for example, the shell which starts the X Window server or otherwise starts the system such as via ssh or when logging in through a tty terminal (not sure why we still pretend these things exist).\"]}),(0,e.jsxs)(t.p,{children:[\"The key caveat on these charts for Mac users is explained \",(0,e.jsx)(t.a,{href:\"https://apple.stackexchange.com/questions/119711/why-doesnt-mac-os-x-source-bashrc\",children:\"here\"}),\": On macOS, launching a new terminal or terminal tab is treated as a login shell. Regardless of your OS, once you are \",(0,e.jsx)(t.em,{children:\"in the terminal\"}),\" subshells (like running \",(0,e.jsx)(t.code,{children:\"bash\"}),\") are \",(0,e.jsx)(t.em,{children:\"not\"}),\" login shells.\"]}),(0,e.jsx)(t.p,{children:(0,e.jsx)(t.strong,{children:\"As a result, most Linux users should read down the second column for their shell, while most Mac users would read down the first.\"})}),(0,e.jsxs)(t.h3,{id:\"bash-startup-scripts\",children:[(0,e.jsx)(t.a,{href:\"#bash-startup-scripts\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(t.span,{className:\"icon icon-link\"})}),(0,e.jsx)(t.code,{children:\"bash\"}),\" startup scripts\"]}),(0,e.jsx)(t.p,{children:\"Bash's startup script strategy is especially complicated for Mac users:\"}),(0,e.jsxs)(t.ul,{children:[(0,e.jsxs)(t.li,{children:[\"For an interactive non-login shell (that is, linux), \",(0,e.jsx)(t.code,{children:\"~/.bashrc\"}),\" is executed and the main point for user customization\"]}),(0,e.jsxs)(t.li,{children:[\"For macOS's interactive non-login shell (even in terminal.app), \",(0,e.jsx)(t.code,{children:\"~/.bashrc\"}),\" is ignored in favor of the \",(0,e.jsx)(t.em,{children:\"first\"}),\" file found of \",(0,e.jsx)(t.code,{children:\"~/.bash_profile\"}),\", \",(0,e.jsx)(t.code,{children:\"~/.bash_login\"}),\" and \",(0,e.jsx)(t.code,{children:\"~/.profile\"}),\" (below, only the \",(0,e.jsx)(t.em,{children:\"first\"}),\" of \",(0,e.jsx)(t.em,{children:\"B1, B2, or B3\"}),\").\"]})]}),(0,e.jsx)(t.p,{children:(0,e.jsxs)(t.strong,{children:[\"To simplify this, the common advice has been to add '\",(0,e.jsx)(t.code,{children:\"source ~/.bashrc\"}),\"' to your \",(0,e.jsx)(t.code,{children:\"~/.bash_profile\"}),\" (the first of the optional login scripts) and keep customizations in \",(0,e.jsx)(t.code,{children:\"~/.bashrc\"}),\".\"]})}),(0,e.jsxs)(t.table,{children:[(0,e.jsx)(t.thead,{children:(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.th,{}),(0,e.jsx)(t.th,{children:\"Interactive login\"}),(0,e.jsx)(t.th,{children:\"Interactive non-login\"}),(0,e.jsx)(t.th,{children:\"Script\"})]})}),(0,e.jsxs)(t.tbody,{children:[(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"/etc/profile\"})}),(0,e.jsx)(t.td,{children:\"A\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"/etc/bash.bashrc\"})}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{children:\"A\"}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.bashrc\"})}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{children:\"B\"}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.bash_profile\"})}),(0,e.jsx)(t.td,{children:\"B1\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.bash_login\"})}),(0,e.jsx)(t.td,{children:\"B2\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.profile\"})}),(0,e.jsx)(t.td,{children:\"B3\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"source $BASH_ENV\"})}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{children:\"A\"})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.em,{children:\"logout only:\"})}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.bash_logout\"})}),(0,e.jsx)(t.td,{children:\"C\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]})]})]}),(0,e.jsxs)(t.h3,{id:\"zsh-startup-scripts\",children:[(0,e.jsx)(t.a,{href:\"#zsh-startup-scripts\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(t.span,{className:\"icon icon-link\"})}),(0,e.jsx)(t.code,{children:\"zsh\"}),\" startup scripts\"]}),(0,e.jsxs)(t.p,{children:[(0,e.jsx)(t.code,{children:\"zsh\"}),\" is straightforward by comparison. It is still a login shell on mac, though most folks only bother with \",(0,e.jsx)(t.code,{children:\".zshrc\"}),\" and there are no strange loading quirks.\"]}),(0,e.jsxs)(t.p,{children:[\"Most folks I know use only \",(0,e.jsx)(t.code,{children:\".zshrc\"}),\" and/or \",(0,e.jsx)(t.a,{href:\"https://ohmyz.sh/\",children:\"Oh my zsh\"}),\" to manage their \",(0,e.jsx)(t.code,{children:\"zsh\"}),\".\"]}),(0,e.jsxs)(t.table,{children:[(0,e.jsx)(t.thead,{children:(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.th,{}),(0,e.jsx)(t.th,{children:\"Interactive login\"}),(0,e.jsx)(t.th,{children:\"Interactive non-login\"}),(0,e.jsx)(t.th,{children:\"Script\"})]})}),(0,e.jsxs)(t.tbody,{children:[(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"/etc/zshenv\"})}),(0,e.jsx)(t.td,{children:\"A\"}),(0,e.jsx)(t.td,{children:\"A\"}),(0,e.jsx)(t.td,{children:\"A\"})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.zshenv\"})}),(0,e.jsx)(t.td,{children:\"B\"}),(0,e.jsx)(t.td,{children:\"B\"}),(0,e.jsx)(t.td,{children:\"B\"})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"/etc/zprofile\"})}),(0,e.jsx)(t.td,{children:\"C\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.zprofile\"})}),(0,e.jsx)(t.td,{children:\"D\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"/etc/zshrc\"})}),(0,e.jsx)(t.td,{children:\"E\"}),(0,e.jsx)(t.td,{children:\"C\"}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.zshrc\"})}),(0,e.jsx)(t.td,{children:\"F\"}),(0,e.jsx)(t.td,{children:\"D\"}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"/etc/zlogin\"})}),(0,e.jsx)(t.td,{children:\"G\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.zlogin\"})}),(0,e.jsx)(t.td,{children:\"H\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.em,{children:\"logout only:\"})}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.zlogout\"})}),(0,e.jsx)(t.td,{children:\"I\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"/etc/zlogout\"})}),(0,e.jsx)(t.td,{children:\"J\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]})]})]}),(0,e.jsxs)(t.h2,{id:\"key-takeaways\",children:[(0,e.jsx)(t.a,{href:\"#key-takeaways\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(t.span,{className:\"icon icon-link\"})}),\"Key Takeaways\"]}),(0,e.jsxs)(t.ul,{children:[(0,e.jsxs)(t.li,{children:[\"Mac shells start out as login shells. This makes \",(0,e.jsx)(t.code,{children:\"bash\"}),\"'s startup script loading order more complicated.\"]}),(0,e.jsxs)(t.li,{children:[\"Put your \",(0,e.jsx)(t.code,{children:\"bash\"}),\" customizations in \",(0,e.jsx)(t.code,{children:\"~/.bashrc\"}),\" and source it from \",(0,e.jsx)(t.code,{children:\"~/.bash_profile\"}),\" to avoid this issue.\"]}),(0,e.jsxs)(t.li,{children:[\"Put your \",(0,e.jsx)(t.code,{children:\"zsh\"}),\" customizations in \",(0,e.jsx)(t.code,{children:\"~/.zshrc\"}),\".\"]}),(0,e.jsxs)(t.li,{children:[\"On a Mac, you can print any welcome or diagnostic messages from \",(0,e.jsx)(t.code,{children:\"~/.bash_profile\"}),\" or \",(0,e.jsx)(t.code,{children:\"~/.zlogin\"}),\".\"]})]}),(0,e.jsxs)(t.h2,{id:\"other-references\",children:[(0,e.jsx)(t.a,{href:\"#other-references\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(t.span,{className:\"icon icon-link\"})}),\"Other References\"]}),(0,e.jsxs)(t.ul,{children:[(0,e.jsx)(t.li,{children:(0,e.jsx)(t.a,{href:\"http://www.joshstaiger.org/archives/2005/07/bash_profile_vs.html\",children:\"A post I read about this in the past, then forgot about\"})}),(0,e.jsx)(t.li,{children:(0,e.jsxs)(t.a,{href:\"https://apple.stackexchange.com/questions/361870/what-are-the-practical-differences-between-bash-and-zsh/361957#361957\",children:[\"Comparing \",(0,e.jsx)(t.code,{children:\"bash\"}),\" and \",(0,e.jsx)(t.code,{children:\"zsh\"}),\" (Stack Exchange)\"]})}),(0,e.jsx)(t.li,{children:(0,e.jsx)(t.a,{href:\"https://unix.stackexchange.com/questions/26676/how-to-check-if-a-shell-is-login-interactive-batch\",children:\"Checking if you are in a login shell (Stack Overflow)\"})}),(0,e.jsx)(t.li,{children:(0,e.jsx)(t.a,{href:\"https://johndjameson.com/blog/updating-your-shell-with-homebrew/\",children:\"Updating your shell, including homebrew-installed shells\"})}),(0,e.jsx)(t.li,{children:(0,e.jsx)(t.a,{href:\"http://zsh.sourceforge.net/Doc/Release/Files.html\",children:\"zsh docs\"})}),(0,e.jsx)(t.li,{children:(0,e.jsx)(t.a,{href:\"http://www.gnu.org/savannah-checkouts/gnu/bash/manual/bash.html#Bash-Startup-Files\",children:\"bash docs\"})})]})]})}}var k=w;return z;})();\n;return Component;","toc":[{"value":"Default shell startup script loading order","url":"#default-shell-startup-script-loading-order","depth":2},{"value":"bash startup scripts","url":"#bash-startup-scripts","depth":3},{"value":"zsh startup scripts","url":"#zsh-startup-scripts","depth":3},{"value":"Key Takeaways","url":"#key-takeaways","depth":2},{"value":"Other References","url":"#other-references","depth":2}],"frontMatter":{"readingTime":{"text":"4 min read","minutes":3.055,"time":183300,"words":611},"slug":"shell-startup-scripts","fileName":"shell-startup-scripts.mdx","title":"Shell startup scripts","date":"2019-12-12T00:00:00.000Z","tags":["unix","linux","macOS","bash","zsh","dotfiles"],"draft":false,"summary":"What loads when in your terminal or shell session","images":[],"layout":"PostLayout"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.375,"time":22500,"words":75},"slug":"default","fileName":"default.md","name":"Erik Stockmeier","avatar":"/static/images/avatar.jpeg","occupation":"Software engineer","email":"email@erikstockmeier.com","twitter":"https://twitter.com/iamerikonline","linkedin":"https://www.linkedin.com/in/erikdstock","github":"https://github.com/erikdstock","date":null}],"prev":null,"next":{"title":"New website","date":"2022-02-13T00:00:00.000Z","tags":[],"draft":false,"summary":"I decided it was time for a fresh start.","images":[],"layout":"PostSimple","slug":"new-website"}},"__N_SSG":true}