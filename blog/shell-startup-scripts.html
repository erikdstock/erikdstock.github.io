<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><link rel="apple-touch-icon" sizes="180x180" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" content="#000000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"/><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>Shell startup scripts</title><meta name="robots" content="follow, index"/><meta name="description" content="What loads when in your terminal or shell session"/><meta property="og:url" content="https://erik-online.com/blog/shell-startup-scripts"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Erik Online"/><meta property="og:description" content="What loads when in your terminal or shell session"/><meta property="og:title" content="Shell startup scripts"/><meta property="og:image" content="https://erik-online.com/static/images/twitter-card.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site"/><meta name="twitter:title" content="Shell startup scripts"/><meta name="twitter:description" content="What loads when in your terminal or shell session"/><meta name="twitter:image" content="https://erik-online.com/static/images/twitter-card.png"/><meta property="article:published_time" content="2019-12-12T00:00:00.000Z"/><link rel="canonical" href="https://erik-online.com/blog/shell-startup-scripts"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://erik-online.com/blog/shell-startup-scripts"
  },
  "headline": "Shell startup scripts",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://erik-online.com/static/images/twitter-card.png"
    }
  ],
  "datePublished": "2019-12-12T00:00:00.000Z",
  "dateModified": "2019-12-12T00:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Erik Stockmeier"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Erik Stockmeier",
    "logo": {
      "@type": "ImageObject",
      "url": "https://erik-online.com/static/images/logo.svg"
    }
  },
  "description": "What loads when in your terminal or shell session"
}</script><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/css/d1f398cc9b75c4a0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d1f398cc9b75c4a0.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-c56a9700e8dfad0a.js" defer=""></script><script src="/_next/static/chunks/main-5c423914abb26902.js" defer=""></script><script src="/_next/static/chunks/pages/_app-4f070aa13683dc23.js" defer=""></script><script src="/_next/static/chunks/framework-327e104994690a53.js" defer=""></script><script src="/_next/static/chunks/545-5dbc8390c9ce3f6a.js" defer=""></script><script src="/_next/static/chunks/460-236a568df36e4e7a.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-76d4b35e450599b9.js" defer=""></script><script src="/_next/static/TXIwnF7zRy5lc6uz6zEMp/_buildManifest.js" defer=""></script><script src="/_next/static/TXIwnF7zRy5lc6uz6zEMp/_ssgManifest.js" defer=""></script><script src="/_next/static/TXIwnF7zRy5lc6uz6zEMp/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="Erik Online" href="/"><div class="flex items-center justify-between"><img alt="Site logo" src="static/images/logo.svg" class="max-w-12 mr-3 max-h-12"/><div class="hidden h-6 text-2xl font-semibold sm:block">Erik Online</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">Blog</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/projects">Projects</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/about">About</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-24 right-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed h-full w-full cursor-auto focus:outline-none"></button><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/projects">Projects</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">About</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Comment" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"></path></svg></button><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2019-12-12T00:00:00.000Z">Thursday, December 12, 2019</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Shell startup scripts</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><img src="/static/images/avatar.jpeg" width="38px" height="38px" alt="avatar" class="h-10 w-10 rounded-full"/><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Erik Stockmeier</dd><dt class="sr-only">Twitter</dt><dd><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/iamerikonline" class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400">@iamerikonline</a></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><p><em>originally published 2019</em></p><blockquote><p>2022 update: When I set up a new M1 Mac work machine homebrew recommended I load it in <a target="_blank" rel="noopener noreferrer" href="https://github.com/erikdstock/dotfiles/blob/c0688bcbe49b27c20ca1310505486120a992a957/homedir/zprofile">my <code>~/.zprofile</code></a>. This complicates the takeaways I give below, but I guess the main update would be that tools you need only for interactive sheels can go in there. My dotfiles need an overhaul.</p></blockquote><p>MacOS 10.15 (Catalina) changed the default shell from <code>bash</code> to <code>zsh</code>, which encouraged me to finally figure out what the heck is going on when I log in and why my dotfiles always feel like such a mess. This includes both the strange loading logic (of <code>bash</code> in particular) as well as the quirks that Apple&#x27;s macOS adds to the mix. It turns out that it&#x27;s not that bad. (Note: for all purposes here I am only talking about shells loaded via a [GUI] Terminal app)</p><h2 id="default-shell-startup-script-loading-order"><a href="#default-shell-startup-script-loading-order" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Default shell startup script loading order</h2><p>The charts below are copied from a <a target="_blank" rel="noopener noreferrer" href="https://shreevatsa.wordpress.com/2008/03/30/zshbash-startup-files-loading-order-bashrc-zshrc-etc/">2008 blog post</a> that stands the test of time.</p><p>They illustrate how a given shell environment selects which scripts to execute on startup, beginning from the top of a given column and continuing through each script marked with a letter in alphabetical order- but only the <em>first</em> file found for each letter. The columns account for varying strategies depending on whether the shell is being created for a script or for an interactive shell and, in the later case, whether the interactive shell is a login shell.</p><p>In Unix terms, a <em>login shell</em> is the shell used at startup - for example, the shell which starts the X Window server or otherwise starts the system such as via ssh or when logging in through a tty terminal (not sure why we still pretend these things exist).</p><p>The key caveat on these charts for Mac users is explained <a target="_blank" rel="noopener noreferrer" href="https://apple.stackexchange.com/questions/119711/why-doesnt-mac-os-x-source-bashrc">here</a>: On macOS, launching a new terminal or terminal tab is treated as a login shell. Regardless of your OS, once you are <em>in the terminal</em> subshells (like running <code>bash</code>) are <em>not</em> login shells.</p><p><strong>As a result, most Linux users should read down the second column for their shell, while most Mac users would read down the first.</strong></p><h3 id="bash-startup-scripts"><a href="#bash-startup-scripts" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>bash</code> startup scripts</h3><p>Bash&#x27;s startup script strategy is especially complicated for Mac users:</p><ul><li>For an interactive non-login shell (that is, linux), <code>~/.bashrc</code> is executed and the main point for user customization</li><li>For macOS&#x27;s interactive non-login shell (even in terminal.app), <code>~/.bashrc</code> is ignored in favor of the <em>first</em> file found of <code>~/.bash_profile</code>, <code>~/.bash_login</code> and <code>~/.profile</code> (below, only the <em>first</em> of <em>B1, B2, or B3</em>).</li></ul><p><strong>To simplify this, the common advice has been to add &#x27;<code>source ~/.bashrc</code>&#x27; to your <code>~/.bash_profile</code> (the first of the optional login scripts) and keep customizations in <code>~/.bashrc</code>.</strong></p><table><thead><tr><th></th><th>Interactive login</th><th>Interactive non-login</th><th>Script</th></tr></thead><tbody><tr><td><code>/etc/profile</code></td><td>A</td><td></td><td></td></tr><tr><td><code>/etc/bash.bashrc</code></td><td></td><td>A</td><td></td></tr><tr><td><code>~/.bashrc</code></td><td></td><td>B</td><td></td></tr><tr><td><code>~/.bash_profile</code></td><td>B1</td><td></td><td></td></tr><tr><td><code>~/.bash_login</code></td><td>B2</td><td></td><td></td></tr><tr><td><code>~/.profile</code></td><td>B3</td><td></td><td></td></tr><tr><td><code>source $BASH_ENV</code></td><td></td><td></td><td>A</td></tr><tr><td><em>logout only:</em></td><td></td><td></td><td></td></tr><tr><td><code>~/.bash_logout</code></td><td>C</td><td></td><td></td></tr></tbody></table><h3 id="zsh-startup-scripts"><a href="#zsh-startup-scripts" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>zsh</code> startup scripts</h3><p><code>zsh</code> is straightforward by comparison. It is still a login shell on mac, though most folks only bother with <code>.zshrc</code> and there are no strange loading quirks.</p><p>Most folks I know use only <code>.zshrc</code> and/or <a target="_blank" rel="noopener noreferrer" href="https://ohmyz.sh/">Oh my zsh</a> to manage their <code>zsh</code>.</p><table><thead><tr><th></th><th>Interactive login</th><th>Interactive non-login</th><th>Script</th></tr></thead><tbody><tr><td><code>/etc/zshenv</code></td><td>A</td><td>A</td><td>A</td></tr><tr><td><code>~/.zshenv</code></td><td>B</td><td>B</td><td>B</td></tr><tr><td><code>/etc/zprofile</code></td><td>C</td><td></td><td></td></tr><tr><td><code>~/.zprofile</code></td><td>D</td><td></td><td></td></tr><tr><td><code>/etc/zshrc</code></td><td>E</td><td>C</td><td></td></tr><tr><td><code>~/.zshrc</code></td><td>F</td><td>D</td><td></td></tr><tr><td><code>/etc/zlogin</code></td><td>G</td><td></td><td></td></tr><tr><td><code>~/.zlogin</code></td><td>H</td><td></td><td></td></tr><tr><td><em>logout only:</em></td><td></td><td></td><td></td></tr><tr><td><code>~/.zlogout</code></td><td>I</td><td></td><td></td></tr><tr><td><code>/etc/zlogout</code></td><td>J</td><td></td><td></td></tr></tbody></table><h2 id="key-takeaways"><a href="#key-takeaways" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Key Takeaways</h2><ul><li>Mac shells start out as login shells. This makes <code>bash</code>&#x27;s startup script loading order more complicated.</li><li>Put your <code>bash</code> customizations in <code>~/.bashrc</code> and source it from <code>~/.bash_profile</code> to avoid this issue.</li><li>Put your <code>zsh</code> customizations in <code>~/.zshrc</code>.</li><li>On a Mac, you can print any welcome or diagnostic messages from <code>~/.bash_profile</code> or <code>~/.zlogin</code>.</li></ul><h2 id="other-references"><a href="#other-references" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Other References</h2><ul><li><a target="_blank" rel="noopener noreferrer" href="http://www.joshstaiger.org/archives/2005/07/bash_profile_vs.html">A post I read about this in the past, then forgot about</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://apple.stackexchange.com/questions/361870/what-are-the-practical-differences-between-bash-and-zsh/361957#361957">Comparing <code>bash</code> and <code>zsh</code> (Stack Exchange)</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://unix.stackexchange.com/questions/26676/how-to-check-if-a-shell-is-login-interactive-batch">Checking if you are in a login shell (Stack Overflow)</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://johndjameson.com/blog/updating-your-shell-with-homebrew/">Updating your shell, including homebrew-installed shells</a></li><li><a target="_blank" rel="noopener noreferrer" href="http://zsh.sourceforge.net/Doc/Release/Files.html">zsh docs</a></li><li><a target="_blank" rel="noopener noreferrer" href="http://www.gnu.org/savannah-checkouts/gnu/bash/manual/bash.html#Bash-Startup-Files">bash docs</a></li></ul></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"><a target="_blank" rel="nofollow" href="https://mobile.twitter.com/search?q=https%3A%2F%2Ferik-online.com%2Fblog%2Fshell-startup-scripts">Discuss on Twitter</a> • <a target="_blank" rel="noopener noreferrer" href="https://github.com/erikdstock/erikdstock.github.io/blob/master/data/blog/shell-startup-scripts.mdx">View on GitHub</a></div><div id="comment"></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/unix">unix</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/linux">linux</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/macos">macOS</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/bash">bash</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/zsh">zsh</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/dotfiles">dotfiles</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Next Article</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/new-website">New website</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog">← Back to the blog</a></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:address@yoursite.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/erikdstock"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/erikdstock"><span class="sr-only">youtube</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M23.499 6.203a3.008 3.008 0 0 0-2.089-2.089c-1.87-.501-9.4-.501-9.4-.501s-7.509-.01-9.399.501a3.008 3.008 0 0 0-2.088 2.09A31.258 31.26 0 0 0 0 12.01a31.258 31.26 0 0 0 .523 5.785 3.008 3.008 0 0 0 2.088 2.089c1.869.502 9.4.502 9.4.502s7.508 0 9.399-.502a3.008 3.008 0 0 0 2.089-2.09 31.258 31.26 0 0 0 .5-5.784 31.258 31.26 0 0 0-.5-5.808zm-13.891 9.4V8.407l6.266 3.604z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/erikdstock"><span class="sr-only">linkedin</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Erik Stockmeier</div><div> • </div><div>© 2022</div><div> • </div><a href="/">Erik Online</a></div><div class="mb-8 text-sm text-gray-500 dark:text-gray-400"><a target="_blank" rel="noopener noreferrer" href="https://github.com/timlrx/tailwind-nextjs-starter-blog">Tailwind Nextjs Theme</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var s=Object.create;var h=Object.defineProperty;var a=Object.getOwnPropertyDescriptor;var o=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty;var d=r=\u003eh(r,\"__esModule\",{value:!0});var m=(r,i)=\u003e()=\u003e(i||r((i={exports:{}}).exports,i),i.exports),g=(r,i)=\u003e{d(r);for(var n in i)h(r,n,{get:i[n],enumerable:!0})},f=(r,i,n)=\u003e{if(i\u0026\u0026typeof i==\"object\"||typeof i==\"function\")for(let t of o(i))!p.call(r,t)\u0026\u0026t!==\"default\"\u0026\u0026h(r,t,{get:()=\u003ei[t],enumerable:!(n=a(i,t))||n.enumerable});return r},b=r=\u003ef(d(h(r!=null?s(u(r)):{},\"default\",r\u0026\u0026r.__esModule\u0026\u0026\"default\"in r?{get:()=\u003er.default,enumerable:!0}:{value:r,enumerable:!0})),r);var c=m((v,l)=\u003e{l.exports=_jsx_runtime});var z={};g(z,{default:()=\u003ek,frontmatter:()=\u003ey});var e=b(c()),y={title:\"Shell startup scripts\",date:\"2019-12-12\",tags:[\"unix\",\"linux\",\"macOS\",\"bash\",\"zsh\",\"dotfiles\"],draft:!1,summary:\"What loads when in your terminal or shell session\",images:[],layout:\"PostLayout\"};function w(r={}){let{wrapper:i}=r.components||{};return i?(0,e.jsx)(i,Object.assign({},r,{children:(0,e.jsx)(n,{})})):n();function n(){let t=Object.assign({p:\"p\",em:\"em\",blockquote:\"blockquote\",a:\"a\",code:\"code\",h2:\"h2\",span:\"span\",strong:\"strong\",h3:\"h3\",ul:\"ul\",li:\"li\",table:\"table\",thead:\"thead\",tr:\"tr\",th:\"th\",tbody:\"tbody\",td:\"td\"},r.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(t.p,{children:(0,e.jsx)(t.em,{children:\"originally published 2019\"})}),(0,e.jsx)(t.blockquote,{children:(0,e.jsxs)(t.p,{children:[\"2022 update: When I set up a new M1 Mac work machine homebrew recommended I load it in \",(0,e.jsxs)(t.a,{href:\"https://github.com/erikdstock/dotfiles/blob/c0688bcbe49b27c20ca1310505486120a992a957/homedir/zprofile\",children:[\"my \",(0,e.jsx)(t.code,{children:\"~/.zprofile\"})]}),\". This complicates the takeaways I give below, but I guess the main update would be that tools you need only for interactive sheels can go in there. My dotfiles need an overhaul.\"]})}),(0,e.jsxs)(t.p,{children:[\"MacOS 10.15 (Catalina) changed the default shell from \",(0,e.jsx)(t.code,{children:\"bash\"}),\" to \",(0,e.jsx)(t.code,{children:\"zsh\"}),\", which encouraged me to finally figure out what the heck is going on when I log in and why my dotfiles always feel like such a mess. This includes both the strange loading logic (of \",(0,e.jsx)(t.code,{children:\"bash\"}),\" in particular) as well as the quirks that Apple's macOS adds to the mix. It turns out that it's not that bad. (Note: for all purposes here I am only talking about shells loaded via a [GUI] Terminal app)\"]}),(0,e.jsxs)(t.h2,{id:\"default-shell-startup-script-loading-order\",children:[(0,e.jsx)(t.a,{href:\"#default-shell-startup-script-loading-order\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(t.span,{className:\"icon icon-link\"})}),\"Default shell startup script loading order\"]}),(0,e.jsxs)(t.p,{children:[\"The charts below are copied from a \",(0,e.jsx)(t.a,{href:\"https://shreevatsa.wordpress.com/2008/03/30/zshbash-startup-files-loading-order-bashrc-zshrc-etc/\",children:\"2008 blog post\"}),\" that stands the test of time.\"]}),(0,e.jsxs)(t.p,{children:[\"They illustrate how a given shell environment selects which scripts to execute on startup, beginning from the top of a given column and continuing through each script marked with a letter in alphabetical order- but only the \",(0,e.jsx)(t.em,{children:\"first\"}),\" file found for each letter. The columns account for varying strategies depending on whether the shell is being created for a script or for an interactive shell and, in the later case, whether the interactive shell is a login shell.\"]}),(0,e.jsxs)(t.p,{children:[\"In Unix terms, a \",(0,e.jsx)(t.em,{children:\"login shell\"}),\" is the shell used at startup - for example, the shell which starts the X Window server or otherwise starts the system such as via ssh or when logging in through a tty terminal (not sure why we still pretend these things exist).\"]}),(0,e.jsxs)(t.p,{children:[\"The key caveat on these charts for Mac users is explained \",(0,e.jsx)(t.a,{href:\"https://apple.stackexchange.com/questions/119711/why-doesnt-mac-os-x-source-bashrc\",children:\"here\"}),\": On macOS, launching a new terminal or terminal tab is treated as a login shell. Regardless of your OS, once you are \",(0,e.jsx)(t.em,{children:\"in the terminal\"}),\" subshells (like running \",(0,e.jsx)(t.code,{children:\"bash\"}),\") are \",(0,e.jsx)(t.em,{children:\"not\"}),\" login shells.\"]}),(0,e.jsx)(t.p,{children:(0,e.jsx)(t.strong,{children:\"As a result, most Linux users should read down the second column for their shell, while most Mac users would read down the first.\"})}),(0,e.jsxs)(t.h3,{id:\"bash-startup-scripts\",children:[(0,e.jsx)(t.a,{href:\"#bash-startup-scripts\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(t.span,{className:\"icon icon-link\"})}),(0,e.jsx)(t.code,{children:\"bash\"}),\" startup scripts\"]}),(0,e.jsx)(t.p,{children:\"Bash's startup script strategy is especially complicated for Mac users:\"}),(0,e.jsxs)(t.ul,{children:[(0,e.jsxs)(t.li,{children:[\"For an interactive non-login shell (that is, linux), \",(0,e.jsx)(t.code,{children:\"~/.bashrc\"}),\" is executed and the main point for user customization\"]}),(0,e.jsxs)(t.li,{children:[\"For macOS's interactive non-login shell (even in terminal.app), \",(0,e.jsx)(t.code,{children:\"~/.bashrc\"}),\" is ignored in favor of the \",(0,e.jsx)(t.em,{children:\"first\"}),\" file found of \",(0,e.jsx)(t.code,{children:\"~/.bash_profile\"}),\", \",(0,e.jsx)(t.code,{children:\"~/.bash_login\"}),\" and \",(0,e.jsx)(t.code,{children:\"~/.profile\"}),\" (below, only the \",(0,e.jsx)(t.em,{children:\"first\"}),\" of \",(0,e.jsx)(t.em,{children:\"B1, B2, or B3\"}),\").\"]})]}),(0,e.jsx)(t.p,{children:(0,e.jsxs)(t.strong,{children:[\"To simplify this, the common advice has been to add '\",(0,e.jsx)(t.code,{children:\"source ~/.bashrc\"}),\"' to your \",(0,e.jsx)(t.code,{children:\"~/.bash_profile\"}),\" (the first of the optional login scripts) and keep customizations in \",(0,e.jsx)(t.code,{children:\"~/.bashrc\"}),\".\"]})}),(0,e.jsxs)(t.table,{children:[(0,e.jsx)(t.thead,{children:(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.th,{}),(0,e.jsx)(t.th,{children:\"Interactive login\"}),(0,e.jsx)(t.th,{children:\"Interactive non-login\"}),(0,e.jsx)(t.th,{children:\"Script\"})]})}),(0,e.jsxs)(t.tbody,{children:[(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"/etc/profile\"})}),(0,e.jsx)(t.td,{children:\"A\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"/etc/bash.bashrc\"})}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{children:\"A\"}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.bashrc\"})}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{children:\"B\"}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.bash_profile\"})}),(0,e.jsx)(t.td,{children:\"B1\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.bash_login\"})}),(0,e.jsx)(t.td,{children:\"B2\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.profile\"})}),(0,e.jsx)(t.td,{children:\"B3\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"source $BASH_ENV\"})}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{children:\"A\"})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.em,{children:\"logout only:\"})}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.bash_logout\"})}),(0,e.jsx)(t.td,{children:\"C\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]})]})]}),(0,e.jsxs)(t.h3,{id:\"zsh-startup-scripts\",children:[(0,e.jsx)(t.a,{href:\"#zsh-startup-scripts\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(t.span,{className:\"icon icon-link\"})}),(0,e.jsx)(t.code,{children:\"zsh\"}),\" startup scripts\"]}),(0,e.jsxs)(t.p,{children:[(0,e.jsx)(t.code,{children:\"zsh\"}),\" is straightforward by comparison. It is still a login shell on mac, though most folks only bother with \",(0,e.jsx)(t.code,{children:\".zshrc\"}),\" and there are no strange loading quirks.\"]}),(0,e.jsxs)(t.p,{children:[\"Most folks I know use only \",(0,e.jsx)(t.code,{children:\".zshrc\"}),\" and/or \",(0,e.jsx)(t.a,{href:\"https://ohmyz.sh/\",children:\"Oh my zsh\"}),\" to manage their \",(0,e.jsx)(t.code,{children:\"zsh\"}),\".\"]}),(0,e.jsxs)(t.table,{children:[(0,e.jsx)(t.thead,{children:(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.th,{}),(0,e.jsx)(t.th,{children:\"Interactive login\"}),(0,e.jsx)(t.th,{children:\"Interactive non-login\"}),(0,e.jsx)(t.th,{children:\"Script\"})]})}),(0,e.jsxs)(t.tbody,{children:[(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"/etc/zshenv\"})}),(0,e.jsx)(t.td,{children:\"A\"}),(0,e.jsx)(t.td,{children:\"A\"}),(0,e.jsx)(t.td,{children:\"A\"})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.zshenv\"})}),(0,e.jsx)(t.td,{children:\"B\"}),(0,e.jsx)(t.td,{children:\"B\"}),(0,e.jsx)(t.td,{children:\"B\"})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"/etc/zprofile\"})}),(0,e.jsx)(t.td,{children:\"C\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.zprofile\"})}),(0,e.jsx)(t.td,{children:\"D\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"/etc/zshrc\"})}),(0,e.jsx)(t.td,{children:\"E\"}),(0,e.jsx)(t.td,{children:\"C\"}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.zshrc\"})}),(0,e.jsx)(t.td,{children:\"F\"}),(0,e.jsx)(t.td,{children:\"D\"}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"/etc/zlogin\"})}),(0,e.jsx)(t.td,{children:\"G\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.zlogin\"})}),(0,e.jsx)(t.td,{children:\"H\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.em,{children:\"logout only:\"})}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"~/.zlogout\"})}),(0,e.jsx)(t.td,{children:\"I\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]}),(0,e.jsxs)(t.tr,{children:[(0,e.jsx)(t.td,{children:(0,e.jsx)(t.code,{children:\"/etc/zlogout\"})}),(0,e.jsx)(t.td,{children:\"J\"}),(0,e.jsx)(t.td,{}),(0,e.jsx)(t.td,{})]})]})]}),(0,e.jsxs)(t.h2,{id:\"key-takeaways\",children:[(0,e.jsx)(t.a,{href:\"#key-takeaways\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(t.span,{className:\"icon icon-link\"})}),\"Key Takeaways\"]}),(0,e.jsxs)(t.ul,{children:[(0,e.jsxs)(t.li,{children:[\"Mac shells start out as login shells. This makes \",(0,e.jsx)(t.code,{children:\"bash\"}),\"'s startup script loading order more complicated.\"]}),(0,e.jsxs)(t.li,{children:[\"Put your \",(0,e.jsx)(t.code,{children:\"bash\"}),\" customizations in \",(0,e.jsx)(t.code,{children:\"~/.bashrc\"}),\" and source it from \",(0,e.jsx)(t.code,{children:\"~/.bash_profile\"}),\" to avoid this issue.\"]}),(0,e.jsxs)(t.li,{children:[\"Put your \",(0,e.jsx)(t.code,{children:\"zsh\"}),\" customizations in \",(0,e.jsx)(t.code,{children:\"~/.zshrc\"}),\".\"]}),(0,e.jsxs)(t.li,{children:[\"On a Mac, you can print any welcome or diagnostic messages from \",(0,e.jsx)(t.code,{children:\"~/.bash_profile\"}),\" or \",(0,e.jsx)(t.code,{children:\"~/.zlogin\"}),\".\"]})]}),(0,e.jsxs)(t.h2,{id:\"other-references\",children:[(0,e.jsx)(t.a,{href:\"#other-references\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(t.span,{className:\"icon icon-link\"})}),\"Other References\"]}),(0,e.jsxs)(t.ul,{children:[(0,e.jsx)(t.li,{children:(0,e.jsx)(t.a,{href:\"http://www.joshstaiger.org/archives/2005/07/bash_profile_vs.html\",children:\"A post I read about this in the past, then forgot about\"})}),(0,e.jsx)(t.li,{children:(0,e.jsxs)(t.a,{href:\"https://apple.stackexchange.com/questions/361870/what-are-the-practical-differences-between-bash-and-zsh/361957#361957\",children:[\"Comparing \",(0,e.jsx)(t.code,{children:\"bash\"}),\" and \",(0,e.jsx)(t.code,{children:\"zsh\"}),\" (Stack Exchange)\"]})}),(0,e.jsx)(t.li,{children:(0,e.jsx)(t.a,{href:\"https://unix.stackexchange.com/questions/26676/how-to-check-if-a-shell-is-login-interactive-batch\",children:\"Checking if you are in a login shell (Stack Overflow)\"})}),(0,e.jsx)(t.li,{children:(0,e.jsx)(t.a,{href:\"https://johndjameson.com/blog/updating-your-shell-with-homebrew/\",children:\"Updating your shell, including homebrew-installed shells\"})}),(0,e.jsx)(t.li,{children:(0,e.jsx)(t.a,{href:\"http://zsh.sourceforge.net/Doc/Release/Files.html\",children:\"zsh docs\"})}),(0,e.jsx)(t.li,{children:(0,e.jsx)(t.a,{href:\"http://www.gnu.org/savannah-checkouts/gnu/bash/manual/bash.html#Bash-Startup-Files\",children:\"bash docs\"})})]})]})}}var k=w;return z;})();\n;return Component;","toc":[{"value":"Default shell startup script loading order","url":"#default-shell-startup-script-loading-order","depth":2},{"value":"bash startup scripts","url":"#bash-startup-scripts","depth":3},{"value":"zsh startup scripts","url":"#zsh-startup-scripts","depth":3},{"value":"Key Takeaways","url":"#key-takeaways","depth":2},{"value":"Other References","url":"#other-references","depth":2}],"frontMatter":{"readingTime":{"text":"4 min read","minutes":3.055,"time":183300,"words":611},"slug":"shell-startup-scripts","fileName":"shell-startup-scripts.mdx","title":"Shell startup scripts","date":"2019-12-12T00:00:00.000Z","tags":["unix","linux","macOS","bash","zsh","dotfiles"],"draft":false,"summary":"What loads when in your terminal or shell session","images":[],"layout":"PostLayout"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.375,"time":22500,"words":75},"slug":"default","fileName":"default.md","name":"Erik Stockmeier","avatar":"/static/images/avatar.jpeg","occupation":"Software engineer","email":"email@erikstockmeier.com","twitter":"https://twitter.com/iamerikonline","linkedin":"https://www.linkedin.com/in/erikdstock","github":"https://github.com/erikdstock","date":null}],"prev":null,"next":{"title":"New website","date":"2022-02-13T00:00:00.000Z","tags":[],"draft":false,"summary":"I decided it was time for a fresh start.","images":[],"layout":"PostSimple","slug":"new-website"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["shell-startup-scripts"]},"buildId":"TXIwnF7zRy5lc6uz6zEMp","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>